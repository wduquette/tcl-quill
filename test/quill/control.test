# -*-Tcl-*-
#-------------------------------------------------------------------------
# TITLE:
#    control.test
#
# AUTHOR:
#    Will Duquette
#
# DESCRIPTION:
#    quill(n): Test cases for control.tcl

#-------------------------------------------------------------------------
# Load the tcltest package

if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest 2.3
    eval ::tcltest::configure $argv
}

namespace import ::tcltest::test

#-------------------------------------------------------------------------
# Load the package to be tested

package require quill
namespace import ::quill::*

#-------------------------------------------------------------------------
# Setup

proc errcatch {script} {
    try {
        uplevel 1 $script
    } on error {result eopts} {
        return "[dict get $eopts -errorcode] $result"
    }

    error "Script should have thrown error"
}



#-------------------------------------------------------------------------
# assert

test assert-1.1 {assert succeeds} -body {
    assert {1 + 1 == 2}
    set result OK
} -result {OK}

test assert-1.2 {assert fails} -body {
    errcatch {
        assert {1 + 1 == 3}
    }
} -result {ASSERT Assertion failed: 1 + 1 == 3}

#---------------------------------------------------------------------
# Clean up and finish

::tcltest::cleanupTests



